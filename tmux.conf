#
# CONFIGURE TERMINAL ENVIRONMENT
#
set -g utf8 on
set -g default-terminal "screen-256color"

set -g status-position top # status on top
set -g display-time 3000 # display messages longer
set -g allow-rename off # prevent overriding names
set -g escape-time 0 # fix escape delay
set -g repeat-time 1000 # lengthen key repeat delay
set -g mode-keys vi # make vimlike
set -g terminal-overrides 'xterm*:smcup@:rmcup@' # sane scrolling

# One-index panes and windows, and maintain their numbering
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

# Enable mouse
set -g mode-mouse on
set -g mouse-select-pane on
set -g mouse-resize-pane on
set -g mouse-select-window on


#
# CONFIGURE BINDINGS
#
# Remap prefix to C-a
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Pane navigation
# Use vim-like motions, and avoid lowerccase letter for modifiers so repeat
# commands don't capture normal typing
unbind Left
unbind Down
unbind Up
unbind Right
unbind h
unbind j
unbind k
unbind l
bind -r ^h select-pane -L
bind -r ^j select-pane -D
bind -r ^k select-pane -U
bind -r ^l select-pane -R
bind -r H resize-pane -L
bind -r J resize-pane -D
bind -r K resize-pane -U
bind -r L resize-pane -R

# Vim-like selection/copy
bind-key -t vi-copy v begin-selection
bind-key -t vi-copy y copy-pipe "clipboard copy"

# Force opening splits to default to columns, and retain working directory
bind s split-window -h -c "#{pane_current_path}"
bind S split-window -v -c "#{pane_current_path}"

# Window navigation
unbind p
unbind n
bind-key -r ^p previous-window
bind-key -r ^n next-window
bind-key -r P swap-window -t -1
bind-key -r N swap-window -t +1

# Ask for name on new window
unbind c
bind-key c command-prompt -p "window name:" "new-window; rename-window '%%'"

# Rename window
bind-key r command-prompt -p "window name:" "rename-window '%%'"

# Reloading macro
bind-key R source-file ~/.tmux.conf \; display "Reloaded!"


#
# CONFIGURE STATUS BAR
#
set -g status on
set -g status-utf8 "on"
set -g status-interval 5
set -g status-justify "left"

set -g status-bg "colour24"
set -g status-fg "colour31"

set -g message-bg "colour24"
set -g message-fg "colour117"
set -g message-command-fg "colour24"
set -g message-command-bg "colour117"

set -g pane-border-fg "colour24"
set -g pane-active-border-fg "colour231"

set -g status-left-length "100"
set -g status-left "#[fg=colour23,bg=colour231] #S #[fg=colour231,bg=colour24]"

set -g window-status-separator ""
set -g window-status-format "#[fg=colour81,bg=colour24] [#I] #W "
set -g window-status-current-format "#[fg=colour24,bg=colour31]#[fg=colour153,bg=colour31] [#I] #W #[fg=colour31,bg=colour24]"

set -g status-right-length "200"
set -g status-right "#(~/.dotfiles/scripts/tmux-prompts.sh) #[fg=colour31,bg=colour24]#[fg=colour153,bg=colour31] %l:%M %p #[fg=colour81]#[fg=colour153] %m/%d/%Y #[fg=colour231,bg=colour31]#[fg=colour23,bg=colour231] $USER@#h "
